let JWM_VERSION="1.0.0",JWM_ASSETS={css:"https://raw.githack.com/jo57430/Web-JWM/refs/heads/master/lib/assets/jwm_1-0-0.css"},JWM={exist:!0,debug:!1,managers:[],wm_nextID:0,w_nextID:0,js_script_hotloaded:[],version_spliter:e=>{var t=[0,0,0];if("string"==typeof e){var i=e.split(".");for(let e=0;e<i.length;e++){var s=i[e];if(s.match(/^[0-9]*$/)&&(t[e]=parseInt(s)),2<=e)break}}return t},version:()=>JWM.version_spliter(JWM_VERSION),version_check:t=>{var e=JWM.version(),i=[0,0,0];let s=!0;if("string"==typeof t&&(t=JWM.version_spliter(t)),!Array.isArray(t))return!1;for(let e=0;e<3;e++)t[e]&&"number"==typeof t[e]&&0<=t[e]&&(i[e]=Math.floor(t[e]));return e[0]!=i[0]&&(s=!1),s=e[1]<i[1]?!1:s},isValid:()=>!0,sleep:async t=>new Promise(e=>{("number"!=typeof t||t<=0)&&(t=.1),setTimeout(e,t)}),returnInfo:(e,t)=>("string"==typeof t&&0<t.length&&(t=(t=t.replace("$v",e?.toString()||"undefined")).replace("$t",typeof e),console.log("%c[  INFO ] %cJWM %c: "+t,"color: #ffffff","color: #dd8888","color: #ffffff")),JWM.debug&&((t=Error().stack.split("\n")[1]?.split("@")||["undefined","undefined"])[0].length<=0&&(t[0]="<anonyme>"),console.log(`%c[ DEBUG ] %cJWM %c: 'returnInfo' has returned a '${typeof e}' => '${e?.toString()||"undefined"}'\n[ TRACE ]  |--> ${t[0]} : `+t[1],"color: #dc8add","color: #dd8888","color: #ffffff")),e),returnWarning:(e,t)=>("string"==typeof t&&0<t.length&&(t=(t=t.replace("$v",e?.toString()||"undefined")).replace("$t",typeof e),console.log("%c[WARNING] %cJWM %c: "+t,"color: #ff7800","color: #dd8888","color: #ffffff")),JWM.debug&&((t=Error().stack.split("\n")[1]?.split("@")||["undefined","undefined"])[0].length<=0&&(t[0]="<anonyme>"),console.log(`%c[ DEBUG ] %cJWM %c: 'returnWarning' has returned a '${typeof e}' => '${e?.toString()||"undefined"}'\n[ TRACE ]  |--> ${t[0]} : `+t[1],"color: #dc8add","color: #dd8888","color: #ffffff")),e),returnError:(t,i,s)=>{if("string"==typeof i&&0<i.length){let e="";i=(i=i.replace("$v",t?.toString()||"undefined")).replace("$t",typeof t),"number"==typeof s&&0<s&&(e=`(ERR_${s.toString().padStart(3,"0")}) `),console.error(`%c[ ERROR ] %cJWM %c${e}%c: %c`+i,"color: #ff0000","color: #dd8888","color: #ff0000","color: #ffffff","color: #ff4000")}return JWM.debug&&((s=Error().stack.split("\n")[1]?.split("@")||["undefined","undefined"])[0].length<=0&&(s[0]="<anonyme>"),console.log(`%c[ DEBUG ] %cJWM %c: 'returnError' has returned a '${typeof t}' => '${t?.toString()||"undefined"}'\n[ TRACE ]  |--> ${s[0]} : `+s[1],"color: #dc8add","color: #dd8888","color: #ffffff")),t},setMainCSS:e=>{"string"==typeof e&&(JWM_ASSETS.css=e)},getMainCSS:()=>!(!JWM_ASSETS.css||""==JWM_ASSETS.css)&&JWM_ASSETS.css,setCustomCSS:e=>{"string"==typeof e&&(JWM_ASSETS["css-override"]=e)},getCustomCSS:()=>!(!JWM_ASSETS["css-override"]||""==JWM_ASSETS["css-override"])&&JWM_ASSETS["css-override"],setAssetsGlobalPath:e=>{if("string"!=typeof e||e.length<=0)return JWM.returnError(void 0,`'JWM.setAssetsGlobalPath' invalid argument (1), expected argument type 'string' with size > 0, received '${typeof e}'`,1);"/"!=e.charAt(e.length-1)&&(e+="/"),JWM_ASSETS.asset_path=e},getAssetsGlobalPath:()=>JWM_ASSETS.asset_path,getAsset:(e,t)=>"string"==typeof e&&JWM_ASSETS[e]?JWM_ASSETS.asset_path+JWM_ASSETS[e]:void 0===t?"undefind":t,setAsset:(e,t)=>"string"!=typeof e||e.length<=0?JWM.returnError(void 0,`'JWM.setAsset' invalid argument (1), expected argument type 'string' with size > 0, received '${typeof e}'`,2):"string"!=typeof t||t.length<=0?JWM.returnError(void 0,`'JWM.setAsset' invalid argument (2), expected argument type 'string' with size > 0, received '${typeof t}'`,3):("/"==t.charAt(0)&&(t=t.slice(1,t.length)),void(JWM_ASSETS[e]=t)),getManager:(i,e)=>"number"!=typeof(i="string"==typeof i?JWM.managers.findIndex((e,t)=>e.matchIdentifier(i)):i)||i<0||i>=JWM.managers.length?e?void 0:JWM.returnError(void 0,`'JWM.getManager' invalid argument (1) or element not found, expected argument type 'number', received '${typeof i}'`,4):JWM.managers[i],isManager:e=>!!JWM.getManager(e,!0),newManager:(e,t)=>new JWM_WindowManager(e,t),remManager:e=>{e=JWM.getManager(e);return!!e&&(e.destructor(),!0)},remAllManager:()=>{for(let e=JWM.managers.length-1;0<=e;e--)JWM.managers[e].destructor();return JWM.managers=[],!0},getWindow:(t,e)=>{for(let e=0;e<JWM.managers.length;e++){var i=JWM.managers[e].getWindow(t,!0);if(i)return i}return e?void 0:JWM.returnError(void 0,`'JWM.getManager' invalid argument (1) or element not found, expected argument type 'number|string', received '${typeof t}'`,5)},isWindow:t=>{for(let e=0;e<JWM.managers.length;e++)if(JWM.managers[e].isWindow(t))return!0;return!1},newWindow:(e,t)=>(JWM.managers[0]||(JWM.returnWarning(void 0,`'JWM.newWindow' No WindowManager was created before this function was executed, A default WindowManager has been created !\nThis is not recommended: first create a WindowManager with 'JWM.newManager()' before using this function for optimal performance.`),JWM.newManager()),JWM.managers[0].newWindow(e,t)),remWindow:e=>!!JWM.managers[0]&&JWM.managers[0].remWindow(e),remAllWindow:()=>{for(let e=JWM.managers.length-1;0<=e;e--)JWM.managers[e].remAllWindow();return!0},getWindowCount:()=>{let t=0;for(let e=0;e<JWM.managers.length;e++)t+=JWM.managers[e].getWindowCount();return t},hide:()=>{JWM.managers[0]&&JWM.managers[0].hide()},show:()=>{JWM.managers[0]&&JWM.managers[0].show()},jsInclude:async s=>new Promise(function(i,e){if("string"==typeof s&&0<s.length)if(JWM.js_script_hotloaded[s])JWM.js_script_hotloaded[s].nb++,i(!0);else{let t=document.createElement("script");t.src=s,t.type="text/javascript",t.defer=!0,document.getElementsByTagName("head")&&document.getElementsByTagName("head")[0]&&document.getElementsByTagName("head")[0].appendChild(t),t.onload=function(){JWM.js_script_hotloaded[s]={nb:1,src:s,element:t};var e=JWM.js_script_hotloaded[s];"function"==typeof JWM_JS_LOAD&&(e.func_load=JWM_JS_LOAD),"function"==typeof JWM_JS_UNLOAD&&(e.func_unload=JWM_JS_UNLOAD),"function"==typeof JWM_JS_OPEN&&(e.func_open=JWM_JS_OPEN),"function"==typeof JWM_JS_UPDATE&&(e.func_update=JWM_JS_UPDATE),"function"==typeof JWM_JS_CLOSE&&(e.func_close=JWM_JS_CLOSE),JWM_JS_LOAD=void 0,JWM_JS_UNLOAD=void 0,JWM_JS_OPEN=void 0,JWM_JS_UPDATE=void 0,JWM_JS_CLOSE=void 0;try{e.func_load&&e.func_load()}catch(e){console.error(e)}i(!0)},t.onerror=function(){e(!1)}}else i(JWM.returnError(!1,`'JWM.jsInclude' invalid argument (1), expected argument type 'string' > 0, received '${typeof s}'`,12))}),jsUninclude:e=>{if("string"!=typeof e||e.length<=0)return JWM.returnError(!1,`'JWM.jsUninclude' invalid argument (1), expected argument type 'string' > 0, received '${typeof e}'`,13);if(!JWM.js_script_hotloaded[e])return JWM.returnError(!1,"'JWM.jsUninclude' invalid argument (1), the requested file is not curently loaded",14);var t=JWM.js_script_hotloaded[e];if(t.nb--,t.nb<=0){try{t.func_unload&&t.func_unload()}catch(e){console.error(e)}t.element.remove(),delete JWM.js_script_hotloaded[e]}return!0}};window.addEventListener("resize",function(e){for(let t=0;t<JWM.managers.length;t++)for(let e=0;e<JWM.managers[t].arr_windows.length;e++)JWM.managers[t].arr_windows[e].browserResize()},!0);class JWM_WindowManager{#bool_removed=!1;#int_uid;#str_identifier;#div_element;#obj_options={mousePassthrough:!1};arr_windows=[];constructor(i,t){if((!i||"string"!=typeof i||i.length<=0)&&(i="jwm_wm_"+JWM.wm_nextID),t&&"object"==typeof t||(t={}),JWM.isManager(i))return JWM.returnError(void 0,`'JWM_WindowManager' invalid argument (1), a Window Manager already exist with the same identifier '${i}'`,6);this.#str_identifier=i,Object.keys(t).forEach(e=>{"object"!=typeof this.#obj_options[e]&&(this.#obj_options[e]=t[e])}),JWM.managers.push(this),this.#int_uid=JWM.wm_nextID,JWM.wm_nextID=JWM.wm_nextID+1;i=document.body;if(!i)return JWM.returnError(void 0,`'JWM_WindowManager' no body found in the page, Window Manager need a body to be defind on the page to proceed.\nThis error appears if the page has not yet been fully loaded or if the function has been called before the element has been defined.`,12);if(!i.getElementsByTagName("jwm_wm")[0]){let e="",t="";JWM.getMainCSS()&&(e=`<link href="${JWM.getMainCSS()}" rel="stylesheet" type="text/css">`),JWM.getCustomCSS()&&(t=`<link href="${JWM.getCustomCSS()}" rel="stylesheet" type="text/css">`),i.insertAdjacentHTML("beforeend",`<jwm_wm id="jwm_wm" style="display:none; z-index: ${10+JWM.wm_nextID};">${e}${t}</jwm_wm>`)}return this.#div_element=i.getElementsByTagName("jwm_wm")[0],this.#obj_options.mousePassthrough&&this.setMousePassthrough(!0),this}destructor(){let i=this.#str_identifier;var e=JWM.managers.findIndex((e,t)=>e.matchIdentifier(i)),e=(this.remAllWindow(),this.#bool_removed=!0,0<=e&&JWM.managers.splice(e,1),document.body);if(JWM.managers.length<=0){var t=e.getElementsByTagName("jwm_wm");for(let e=t.length-1;0<=e;e--)t[e].remove()}}toString(){return`[JWM_WindowManager,${this.#int_uid},${this.#str_identifier}]`}matchIdentifier(e){return"string"==typeof e&&this.#str_identifier==e}getIdentifier(){return this.#str_identifier}getWindow(t,e){if("string"!=typeof t&&"number"!=typeof t)return JWM.returnError(void 0,`'JWM_WindowManager.getWindow()' invalid argument (1), expected argument type 'number|string', received '${typeof t}'`,7);for(let e=0;e<this.arr_windows.length;e++)if("string"==typeof t&&this.arr_windows[e].matchIdentifier(t)||"number"==typeof t&&this.arr_windows[e].matchUID(t))return this.arr_windows[e];return e?void 0:JWM.returnError(void 0,"'JWM_WindowManager.getWindow()' invalid argument (1), window not found !",8)}isWindow(e){return!!this.getWindow(e,!0)}newWindow(e,t){return"none"==this.#div_element.style.display&&this.show(),new JWM_Window(this,e,t)}remWindow(e){e=this.getWindow(e);return!!e&&(e.destructor(),JWM.getWindowCount()<=0?this.hide():0<this.arr_windows.length&&this.arr_windows[this.arr_windows.length-1].setFocus(),!0)}remAllWindow(){for(let e=this.arr_windows.length-1;0<=e;e--)this.arr_windows[e].destructor();return JWM.getWindowCount()<=0&&(this.#div_element.style.display="none"),this.arr_windows=[],!0}getWindowCount(){return this.arr_windows.length}hide(){this.#div_element.style.display="none"}show(){this.#div_element.style.display="block"}setMousePassthroughOption(e){"boolean"==typeof e&&(this.#obj_options.mousePassthrough=e,this.setMousePassthrough(e))}setMousePassthrough(e){this.#div_element.style.pointerEvents=e?"none":"auto"}getMousePassthrough(){return this.#obj_options.mousePassthrough}getLayer(e){e=this.getWindow(e,!0);return e?e.getLayer():-1}getFocused(){return this.arr_windows.length-1}setLayer(e,t){if("number"==typeof e&&this.arr_windows[e]&&"number"==typeof t&&this.arr_windows[t])if(0<this.arr_windows[t].getMinLayer()&&this.arr_windows[t].getMinLayer()>e)this.arr_windows[t].unFocus();else{0<this.arr_windows[e].getMinLayer()&&this.arr_windows[e].getMinLayer()<=t&&this.arr_windows[e].getMinLayer(),t>=this.arr_windows.length-1?this.#div_element.insertAdjacentElement("beforeend",this.arr_windows[e].getElement()):this.#div_element.insertBefore(this.arr_windows[t].getElement(),this.arr_windows[e].getElement());var i=this.arr_windows[e];this.arr_windows.splice(e,1),this.arr_windows.splice(t,0,i);for(let e=0;e<this.arr_windows.length-1;e++)this.arr_windows[e].unFocus()}}setFocus(e){this.setLayer(e,this.getFocused())}}class JWM_Window{#class_windowManager;#bool_removed=!1;#int_uid;#str_identifier;#div_element;#obj_options={x:64,y:64,center:!1,center_vertical:!1,center_horizontal:!1,width:640,min_width:-1,max_width:-1,height:400,min_height:-1,max_height:-1,restore:!1,help:!1,close:!0,minimize:!0,maximize:!0,icon:"",layerMove:!0,min_layer:0,iconOnClick:!1,isStatePersistent:!0,startMinimize:!1,startMaximize:!1,movable:!0,resizable:!0};#obj_state={init:!1,isOpen:!1,isFocus:!1,mb_x:64,mb_y:64,mb_w:640,mb_h:400,isMinimize:!1,isMaximize:!1,draging:!1,md_x:0,md_y:0,resizeing:!1,rd_x:0,rd_y:0};#arr_headJS=[];#arr_lincked=[];constructor(e,t,i){if((!t||"string"!=typeof t||t.length<=0)&&(t="jwm_w_"+JWM.w_nextID),i&&"object"==typeof i||(i={}),!e||"object"!=typeof e||"JWM_WindowManager"!=e.constructor.name)return JWM.returnError(void 0,"'JWM_Window' invalid argument (1), The parent class is invalid !",9);if(JWM.isWindow(t))return JWM.returnError(void 0,`'JWM_Window' invalid argument (2), This window identifier '${t}' is already used !`,10);this.#class_windowManager=e,this.#str_identifier=t,this.setOption(i),this.#int_uid=JWM.w_nextID,JWM.w_nextID=JWM.w_nextID+1;i=document.body.getElementsByTagName("jwm_wm")[0];return i?(i.insertAdjacentHTML("beforeend",`<jwm_w id="${t}"></jwm_w>`),this.#div_element=i.children[t],(this.#div_element.window=this).hide(),e.arr_windows.push(this),this):JWM.returnError(void 0,"'JWM_Window' this is strange, The HTML elements 'jwm_wm' is missing form the page. It has probably been deleted by a third-party script.",11)}destructor(){this.close(),this.#bool_removed=!0,this.#div_element&&this.#div_element.remove();for(let e=0;e<this.#class_windowManager.arr_windows.length;e++)if(this.#class_windowManager.arr_windows[e]==this){this.#class_windowManager.arr_windows.splice(e,1);break}}toString(){return`[JWM_Window,${this.#int_uid},${this.#str_identifier}]`}isValid(){return!(this.#bool_removed||!this.#obj_options||!this.#obj_state)}#initState(){this.#obj_options.isStatePersistent&&this.#obj_state.init||(this.#obj_state.init=!0,this.#obj_state.isFocus=!1,this.#obj_state.mb_x=this.#obj_options.x,this.#obj_state.mb_y=this.#obj_options.y,this.#obj_state.mb_w=this.#obj_options.width,this.#obj_state.mb_h=this.#obj_options.height,this.#obj_state.isMinimize=this.#obj_options.startMinimize,this.#obj_state.isMaximize=this.#obj_options.startMaximize)}#initWindow(e,t){this.#initState(),this.#div_element.innerHTML=`<jwm_w_head><jwm_w_head_title>${e}</jwm_w_head_title><jwm_w_head_control></jwm_w_head_control></jwm_w_head><jwm_w_body>${t}</jwm_w_body>`;this.getTitlebarElement(),this.getBodyElement();this.#obj_options.close&&this.addButton("close"),this.#obj_options.maximize&&this.addButton("maximize"),this.#obj_options.minimize&&this.addButton("minimize"),this.#obj_options.help&&this.addButton("help"),this.#obj_options.restore&&this.addButton("restore"),this.#obj_options.movable&&this.enableMove(),this.#obj_options.resizable&&this.enableResize(),this.#obj_options.layerMove&&this.enableLayerMove(),this.#obj_options.icon&&this.setIcon(this.#obj_options.icon),this.#obj_options.center||this.#obj_options.center_vertical&&this.#obj_options.center_horizontal?this.setCenter(5):this.#obj_options.center_vertical?(this.setCenter(5),this.setX(this.#obj_state.mb_x)):this.#obj_options.center_horizontal?(this.setCenter(5),this.setY(this.#obj_state.mb_y)):this.setPos(this.#obj_state.mb_x,this.#obj_state.mb_y),this.setSize(this.#obj_state.mb_w,this.#obj_state.mb_h),this.#obj_state.isMinimize?(this.#obj_state.isMinimize=!1,this.minimize()):this.#obj_state.isMaximize&&(this.#obj_state.isMaximize=!1,this.maximize()),this.setFocus()}#extractScriptSrcFromBody(t){var i=[];if("string"!=typeof t||t.length<=0)return["",i];for(let e=(i=t.match(/<script .*>.*<\/script>|<script .*>/gm)||[]).length-1;0<=e;e--)i[e].match(/(?<=src=["'`]).*(?=["'`][ >])/)?(t=t.replace(i[e],""),i[e]=i[e].match(/(?<=src=["'`]).*(?=["'`][ >])/)[0]):i.splice(e);return[t,i]}async#loadJS(t){if("object"==typeof t&&Array.isArray(t))for(let e=0;e<t.length;e++)"string"!=typeof t[e]||t[e].length<=0||await JWM.jsInclude(t[e])&&this.#arr_headJS.push(t[e])}#unloadJS(){for(let e=this.#arr_headJS.length-1;0<=e;e--)JWM.jsUninclude(this.#arr_headJS[e]);return this.#arr_headJS=[],!0}#call_jsOpen(...t){for(let e=this.#arr_headJS.length;0<=e;e--){var i=JWM.js_script_hotloaded[this.#arr_headJS[e]];i&&"function"==typeof i.func_open&&i.func_open(this,...t)}}#call_jsUpdate(...t){for(let e=this.#arr_headJS.length;0<=e;e--){var i=JWM.js_script_hotloaded[this.#arr_headJS[e]];i&&"function"==typeof i.func_update&&i.func_update(this,...t)}}#call_jsClose(...t){for(let e=this.#arr_headJS.length;0<=e;e--){var i=JWM.js_script_hotloaded[this.#arr_headJS[e]];i&&"function"==typeof i.func_close&&i.func_close(this,...t)}}#getMousePosFromEvent(e){let t=0,i=0;return"object"==typeof e&&("mousemove"!=e.type&&"mousedown"!=e.type&&"mouseup"!=e.type||(t=e.clientX,i=e.clientY),"touchmove"!=e.type&&"touchstart"!=e.type&&"touchend"!=e.type||(t=e.targetTouches[0].screenX,i=e.targetTouches[0].screenY)),[t,i]}#event_startDrag(e){var t,i,s;("mousedown"==e.type&&1==e.which||"touchstart"==e.type&&e.targetTouches[0])&&document.body&&!this.#obj_state.draging&&this.#div_element&&!this.#obj_state.resizeing&&([t,i]=this.#getMousePosFromEvent(e),s=e.target.getBoundingClientRect(),this.#obj_state.md_x=t-s.left,this.#obj_state.md_y=i-s.top,document.JWM_temp={e:e=>{this.#event_endDrag(e)},m:e=>{this.#event_moveWindow(e)}},"mousedown"==e.type&&(document.body.addEventListener("mouseleave",document.JWM_temp.e),document.body.addEventListener("mouseup",document.JWM_temp.e),document.body.addEventListener("mousemove",document.JWM_temp.m)),"touchstart"==e.type&&(document.body.addEventListener("touchcancel",document.JWM_temp.e),document.body.addEventListener("touchend",document.JWM_temp.e),document.body.addEventListener("touchmove",document.JWM_temp.m)),this.#obj_state.draging=!0,this.#class_windowManager.getMousePassthrough())&&this.#class_windowManager.setMousePassthrough(!1)}#event_endDrag(e){document.body&&this.#obj_state.draging&&(document.body.removeEventListener("mouseleave",document.JWM_temp.e),document.body.removeEventListener("mouseup",document.JWM_temp.e),document.body.removeEventListener("mousemove",document.JWM_temp.m),document.body.removeEventListener("touchcancel",document.JWM_temp.e),document.body.removeEventListener("touchend",document.JWM_temp.e),document.body.removeEventListener("touchmove",document.JWM_temp.m),document.JWM_temp=null,this.#obj_state.md_x=0,this.#obj_state.md_y=0,this.#obj_state.draging=!1,this.#class_windowManager.getMousePassthrough())&&this.#class_windowManager.setMousePassthrough(!0)}#event_moveWindow(e){var t;this.#obj_state.draging&&this.#div_element&&([e,t]=this.#getMousePosFromEvent(e),e=e-this.#obj_state.md_x,t=t-this.#obj_state.md_y,this.setPos(e,t))}#event_startResize(e){var t,i,s,n;("mousedown"==e.type&&1==e.which||"touchstart"==e.type&&e.targetTouches[0])&&document.body&&!this.#obj_state.resizeing&&this.#div_element&&!this.#obj_state.draging&&([t,i]=this.#getMousePosFromEvent(e),s=e.target.getBoundingClientRect(),n=e.target.parentNode.getBoundingClientRect(),this.#obj_state.rd_x=t+(n.left-s.right),this.#obj_state.rd_y=i+(n.top-s.bottom),document.JWM_temp={e:e=>{this.#event_endResize(e)},m:e=>{this.#event_moveResize(e)}},"mousedown"==e.type&&(document.body.addEventListener("mouseleave",document.JWM_temp.e),document.body.addEventListener("mouseup",document.JWM_temp.e),document.body.addEventListener("mousemove",document.JWM_temp.m)),"touchstart"==e.type&&(document.body.addEventListener("touchcancel",document.JWM_temp.e),document.body.addEventListener("touchend",document.JWM_temp.e),document.body.addEventListener("touchmove",document.JWM_temp.m)),this.#obj_state.resizeing=!0,this.#class_windowManager.getMousePassthrough())&&this.#class_windowManager.setMousePassthrough(!1)}#event_endResize(e){document.body&&this.#obj_state.resizeing&&(document.body.removeEventListener("mouseleave",document.JWM_temp.e),document.body.removeEventListener("mouseup",document.JWM_temp.e),document.body.removeEventListener("mousemove",document.JWM_temp.m),document.body.removeEventListener("touchcancel",document.JWM_temp.e),document.body.removeEventListener("touchend",document.JWM_temp.e),document.body.removeEventListener("touchmove",document.JWM_temp.m),document.JWM_temp=null,this.#obj_state.rd_x=0,this.#obj_state.rd_y=0,this.#obj_state.resizeing=!1,this.#class_windowManager.getMousePassthrough())&&this.#class_windowManager.setMousePassthrough(!0)}#event_moveResize(e){var t;this.#obj_state.resizeing&&this.#div_element&&([e,t]=this.#getMousePosFromEvent(e),e=e-this.#obj_state.rd_x,t=t-this.#obj_state.rd_y,this.setSize(e,t))}matchIdentifier(e){return!("string"!=typeof e||!this.isValid())&&this.#str_identifier==e}getIdentifier(){return this.isValid()?this.#str_identifier:"removed"}matchUID(e){return!("number"!=typeof e||!this.isValid())&&this.#int_uid==e}getUID(){return this.isValid()?this.#int_uid:-1}getElement(){return this.#div_element}async open(e,t,...i){if(this.isValid()){if(this.#obj_state.isOpen)return this.update(e,t,...i);("string"!=typeof e||e.length<=0)&&(e="JWM Window"),"string"!=typeof t&&(t="Hello World"),this.#obj_state.isOpen=!0,this.hide();t=this.#extractScriptSrcFromBody(t);await this.#loadJS(t[1]),this.#initWindow(e,t[0]);try{this.#call_jsOpen(...i)}catch(e){console.error(e)}try{this.onOpen(...i)}catch(e){console.error(e)}this.show(),await JWM.sleep(.5)}}close(...e){if(this.isValid()&&this.#obj_state.isOpen){this.#obj_state.isOpen=!1,this.hide();try{this.#call_jsClose(...e)}catch(e){console.error(e)}try{this.onClose(...e)}catch(e){console.error(e)}this.#div_element.innerHTML="",this.#unloadJS();for(let e=0;e<this.#arr_lincked.length;e++)this.#arr_lincked[e].close()}}async update(e,t,...i){if(this.isValid()){this.close(...i);try{this.#call_jsUpdate(...i)}catch(e){console.error(e)}await this.open(e,t,...i)}}remove(){if(this.isValid()){for(let e=0;e<this.#arr_lincked.length;e++)this.#arr_lincked[e].remove();this.#arr_lincked=[],this.#class_windowManager.remWindow(this.#int_uid)}}show(){this.isValid()&&"none"==this.#div_element.style.display&&(this.#div_element.style.display=null)}hide(){this.isValid()&&"none"!=this.#div_element.style.display&&(this.#div_element.style.display="none")}isMinimize(){return this.#obj_state.isMinimize}minimize(){var e;this.isValid()&&this.getBodyElement()&&(this.#obj_state.isMaximize&&this.maximize(),this.#obj_state.isMinimize=!this.#obj_state.isMinimize,e=this.getBodyElement(),this.#obj_state.isMinimize?(this.#obj_state.mb_h=this.#div_element.clientHeight,e.style.display="none",this.setHeight(this.getTitlebarHeight()+this.getMarginHeight(),!0),this.disableResize()):(this.setHeight(this.#obj_state.mb_h),e.style.display=null,this.#obj_options.resizable&&this.enableResize()))}isMaximize(){return this.#obj_state.isMaximize}maximize(){this.#div_element&&this.isValid()&&(this.#obj_state.isMinimize&&this.minimize(),this.#obj_state.isMaximize=!this.#obj_state.isMaximize,this.#obj_state.isMaximize?(this.#obj_state.mb_x=this.getX(),this.#obj_state.mb_y=this.getY(),this.#obj_state.mb_w=this.#div_element.clientWidth,this.#obj_state.mb_h=this.#div_element.clientHeight,this.setPos(0,0),this.setSize(window.innerWidth,window.innerHeight,!0),this.disableMove(),this.disableResize()):(this.setPos(this.#obj_state.mb_x,this.#obj_state.mb_y),this.setSize(this.#obj_state.mb_w,this.#obj_state.mb_h),this.#obj_options.movable&&this.enableMove(),this.#obj_options.resizable&&this.enableResize()))}browserResize(){var[e,t]=this.getPos();this.setPos(e,t)}getHeadElement(){if(this.#div_element&&this.isValid())return this.#div_element.getElementsByTagName("jwm_w_head")?.[0]}getTitlebarElement(){if(this.#div_element&&this.isValid())return this.#div_element.getElementsByTagName("jwm_w_head_title")?.[0]}getControlElement(){if(this.#div_element&&this.isValid())return this.#div_element.getElementsByTagName("jwm_w_head_control")?.[0]}getTitlebarButtonElement(t){if(this.getControlElement()&&"string"==typeof t&&this.isValid()){var i=this.getControlElement().getElementsByTagName("button");for(let e=0;e<i.length;e++)if(i[e].ariaLabel==t)return i[e]}}getBodyElement(){if(this.#div_element&&this.isValid())return this.#div_element.getElementsByTagName("jwm_w_body")?.[0]}getResizeElement(){if(this.#div_element&&this.isValid())return this.#div_element.getElementsByTagName("jwm_w_resize")?.[0]}getTitlebarHeight(){var e;if(this.isValid())return(e=this.getTitlebarElement())?e.offsetHeight:0}getTitlebarWidth(){var e;if(this.isValid())return(e=this.getTitlebarElement())?e.offsetWidth:0}getControlHeight(){var e;if(this.isValid())return(e=this.getControlElement())?e.offsetHeight:0}getControlWidth(){var e;if(this.isValid())return(e=this.getControlElement())?e.offsetHeight:0}getBodyHeight(){var e;if(this.isValid())return(e=this.getBodyElement())?e.offsetHeight:0}getBodyWidth(){var e;if(this.isValid())return(e=this.getBodyElement())?e.offsetWidth:0}getHeight(){if(this.isValid())return this.#div_element&&this.isValid()?this.#div_element.offsetHeight:0}getWidth(){if(this.isValid())return this.#div_element&&this.isValid()?this.#div_element.offsetWidth:0}getSize(){return[this.getWidth(),this.getHeight()]}getMarginHeight(){return this.#div_element&&this.isValid()?this.#div_element.offsetHeight-this.#div_element.clientHeight:0}getMarginWidth(){return this.#div_element&&this.isValid()?this.#div_element.offsetWidth-this.#div_element.clientWidth:0}getX(){return this.#div_element&&this.isValid()?this.#div_element.getBoundingClientRect().left:0}getY(){return this.#div_element&&this.isValid()?this.#div_element.getBoundingClientRect().top:0}getPos(){return[this.getX(),this.getY()]}setX(e,t){"number"==typeof e&&this.isValid()&&(t||(e=e<=128-this.getWidth()?128-this.getWidth():e)>=window.innerWidth-128&&(e=window.innerWidth-128),this.#div_element.style.left=e+"px")}setY(e,t){"number"==typeof e&&this.isValid()&&(t||(e=e<=0?0:e)>=window.innerHeight-this.getTitlebarHeight()-this.getMarginHeight()&&(e=window.innerHeight-this.getTitlebarHeight()-this.getMarginHeight()),this.#div_element.style.top=e+"px")}setPos(e,t,i){this.setX(e,i),this.setY(t,i)}setWidth(e,t){"number"==typeof e&&this.isValid()&&(t||((e=e<=160+this.getControlWidth()?160+this.getControlWidth():e)>window.innerWidth&&(e=window.innerWidth),0<=this.#obj_options.min_width&&e<=this.#obj_options.min_width&&(e=this.#obj_options.min_width),0<=this.#obj_options.max_width&&e>this.#obj_options.max_width&&(e=this.#obj_options.max_width)),this.#div_element.style.width=e+"px")}setHeight(e,t){"number"==typeof e&&this.isValid()&&(t||((e=e<=32+this.getTitlebarHeight()+this.getMarginHeight()&&!this.#obj_state.isMinimize?32+this.getTitlebarHeight()+this.getMarginHeight():e)>window.innerHeight&&(e=window.innerHeight),0<=this.#obj_options.min_height&&e<=this.#obj_options.min_height&&(e=this.#obj_options.min_height),0<=this.#obj_options.max_height&&e>this.#obj_options.max_height&&(e=this.#obj_options.max_height)),this.#div_element.style.height=e+"px")}setSize(e,t,i){this.setWidth(e,i),this.setHeight(t,i)}isLinkedWindow(t){if("object"!=typeof t||"JWM_Window"!=t.constructor.name)return!0;for(let e=0;e<this.#arr_lincked.length;e++)if(this.#arr_lincked[e]==t)return!0;return!1}addLinkedWindow(e){this.isLinkedWindow(e)||this.#arr_lincked.push(e)}getLinkedWindow(){return this.#arr_lincked}remLinkedWindow(t){if("object"==typeof t&&"JWM_Window"==t.constructor.name&&this.isLinkedWindow(t))for(let e=0;e<this.#arr_lincked.length;e++)if(this.#arr_lincked[e]==t){this.#arr_lincked.splice(e,1);break}}remAllLinkedWindow(){this.#arr_lincked=[]}isFocused(){return this.#obj_state.isFocus}getLayer(){for(let e=0;e<this.#class_windowManager.arr_windows.length;e++)if(this==this.#class_windowManager.arr_windows[e])return e;return-1}getMinLayer(){return this.#obj_options.min_layer}setLayer(e){this.#class_windowManager.setLayer(this.getLayer(),e)}unFocus(){var e;this.isValid()&&this.#obj_state.isFocus&&(this.#obj_state.isFocus=!1,this.#obj_options.layerMove)&&(e=this.getHeadElement())&&(e.className="disabled")}setFocus(){var e;this.isValid()&&!this.#obj_state.isFocus&&(this.#obj_state.isFocus=!0,this.#class_windowManager.setFocus(this.getLayer()),e=this.getHeadElement())&&(e.className="")}setIcon(i){if("string"==typeof i){var s=this.getHeadElement();let t;if((t=s?s.getElementsByTagName("img")?.[0]:t)||0!=i.length)if(t&&0==i.length)t.remove();else{t||(s.insertAdjacentHTML("afterbegin",'<img src="" alt=""/>'),t=s.getElementsByTagName("img")?.[0],this.#obj_options.iconOnClick&&(t.addEventListener("mousedown",e=>{1==e.which&&this.onIcon()}),t.style.cursor="pointer"));s=this.getTitlebarElement();let e="Icon of : ";s&&(e+=s.innerHTML),t.alt=e,t.src=i}}}enableMove(){var e;this.getTitlebarElement()&&this.isValid()&&((e=this.getTitlebarElement()).JWM_temp||(e.JWM_temp={}),e.JWM_temp&&e.JWM_temp.m||(e.JWM_temp.m=e=>{this.#event_startDrag(e)},e.addEventListener("mousedown",e.JWM_temp.m),e.addEventListener("touchstart",e.JWM_temp.m),e.style.cursor="grab"))}disableMove(){var e;this.getTitlebarElement()&&this.isValid()&&(e=this.getTitlebarElement()).JWM_temp&&e.JWM_temp.m&&(this.#event_endDrag(),e.removeEventListener("mousedown",e.JWM_temp.m),e.removeEventListener("touchstart",e.JWM_temp.m),e.JWM_temp.m=null,e.style.cursor=null)}enableResize(){var e;this.#div_element&&!this.getResizeElement()&&this.isValid()&&(this.#div_element.insertAdjacentHTML("beforeend","<jwm_w_resize></jwm_w_resize>"),(e=this.getResizeElement()).JWM_temp||(e.JWM_temp={}),e.JWM_temp.m=e=>{this.#event_startResize(e)},e.addEventListener("mousedown",e.JWM_temp.m),e.addEventListener("touchstart",e.JWM_temp.m))}disableResize(){this.getResizeElement()&&this.isValid()&&(this.#event_endResize(),this.getResizeElement().remove())}addButton(e){var t;this.isValid()&&"string"==typeof e&&this.getControlElement()&&!this.getTitlebarButtonElement(e)&&(t=this.getControlElement(),"restore"==e.toLowerCase()&&(t.insertAdjacentHTML("afterbegin",'<button aria-label="Restore" type="button"></button>'),this.getTitlebarButtonElement("Restore").addEventListener("mousedown",e=>{1==e.which&&this.onRestore()})),"help"==e.toLowerCase()&&(t.insertAdjacentHTML("afterbegin",'<button aria-label="Help" type="button"></button>'),this.getTitlebarButtonElement("Help").addEventListener("mousedown",e=>{1==e.which&&this.onHelp()})),"minimize"==e.toLowerCase()&&(t.insertAdjacentHTML("afterbegin",'<button aria-label="Minimize" type="button"></button>'),this.getTitlebarButtonElement("Minimize").addEventListener("mousedown",e=>{1==e.which&&this.minimize()})),"maximize"==e.toLowerCase()&&(t.insertAdjacentHTML("afterbegin",'<button aria-label="Maximize" type="button"></button>'),this.getTitlebarButtonElement("Maximize").addEventListener("mousedown",e=>{1==e.which&&this.maximize()})),"close"==e.toLowerCase())&&(t.insertAdjacentHTML("afterbegin",'<button aria-label="Close" type="button"></button>'),this.getTitlebarButtonElement("Close").addEventListener("mousedown",e=>{1==e.which&&this.remove()}))}remButton(e){this.isValid()&&"string"==typeof e&&this.getTitlebarButtonElement(e)&&this.getTitlebarButtonElement(e).remove()}enableLayerMove(){this.isValid()&&this.#div_element&&(this.#div_element.JWM_temp||(this.#div_element.JWM_temp={}),this.#div_element.JWM_temp.l=e=>{this.isFocused()||this.setFocus()},this.#div_element.addEventListener("mousedown",this.#div_element.JWM_temp.l),this.#div_element.addEventListener("touchstart",this.#div_element.JWM_temp.l))}disableLayerMove(){this.#div_element&&this.isValid()&&this.#div_element.JWM_temp&&this.#div_element.JWM_temp.l&&(this.#div_element.removeEventListener("mousedown",this.#div_element.JWM_temp.l),this.#div_element.removeEventListener("touchstart",this.#div_element.JWM_temp.l),this.#div_element.JWM_temp.m=null)}setCenter(i){if(this.isValid()&&!("number"!=typeof i||i<1||9<i)){let e=0,t=0;7==i||8==i?t=0:4==i||5==i||6==i?t=.5*window.innerHeight-.5*this.getHeight():1!=i&&2!=i&&3!=i||(t=window.innerHeight-this.getHeight()),1==i||4==i||7==i?e=0:2==i||5==i||8==i?e=.5*window.innerWidth-.5*this.getWidth():3!=i&&6!=i&&9!=i||(e=window.innerWidth-this.getWidth()),this.setPos(e,t)}}setOption(t){this.isValid()&&(t&&"object"==typeof t||(t={}),Object.keys(t).forEach(e=>{"object"!=typeof this.#obj_options[e]&&typeof this.#obj_options[e]==typeof t[e]&&(this.#obj_options[e]=t[e])}),this.#obj_state.init=!1)}onOpen(){}onClose(){}onUpdate(){}onHelp(){}onRestore(){this.#obj_state.isMaximize&&this.maximize(),this.#obj_state.isMinimize&&this.minimize(),this.setPos(this.#obj_options.x,this.#obj_options.y),this.setSize(this.#obj_options.width,this.#obj_options.height)}onIcon(){}}JWM.returnInfo(void 0,`'Jo Windows Manager' vestion '${JWM_VERSION}' loaded !`);